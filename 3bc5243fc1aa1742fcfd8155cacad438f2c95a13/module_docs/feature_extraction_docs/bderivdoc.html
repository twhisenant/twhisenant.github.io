
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Feature Derivation &#8212; DataCloud Rhino 1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">DataCloud Rhino 1.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="feature-derivation">
<h1>Feature Derivation<a class="headerlink" href="#feature-derivation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="external-derivations">
<h2>External Derivations<a class="headerlink" href="#external-derivations" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><span class="target" id="module-external_feature_derivations"></span><p>Created on Tue Dec 18 19:29:08 2018</p>
<p>&#64;author: kkappler</p>
<dl class="class">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0">
<em class="property">class </em><code class="descname">DerivedFeatureExtractorV0</code><span class="sig-paren">(</span><em>df</em><span class="sig-paren">)</span><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes as input the extracted features dataframe (or csv-loads)
and calcualtes the derived features;
May factor this into axial, tangential but for now do as all-one
a_delay
a_dens
a_mod
a_reflection_coefficient
a_vel
a_str
c_modulus
c_strength
c_velocity
density
Error_Flag
hole_id
QC_FLAG
s_modulus
s_velocity
t_delay
t_mod
t_reflection_coef
a_delay:  a_delay = axial_multiple_peak_time_sample - axial_primary_peak_time_sample</p>
<p>This formula resulted in a ‘blocky’ looking log because the sample-granularity
that was applied resulted in only a few discrete values being observed.
Variation over a blasthole was often only observed to have three or four
distinct values.  When smoothing was applied to these logs they looked
somewhat plausible.  We can reduce the blockyness by using
axial_multiple_peak_time_poly, and axial_primary_peak_time_poly, i.e.
the polyfit critical points rather than those at sample granularity.</p>
<p>a_dens:  a_reflection_coef / a_vel^2
Previously known as “pseudo_density”, we have been calculating it as:
a_dens = reflection_coefficient_sample / primary_pseudo_velocity_sample**2
Where the primary_pseudo_velocity_sample = 1. / self.primary_wavelet_width_sample
Which can be expressed as
a_dens = reflection_coefficient_sample * self.primary_wavelet_width_sample**2
N.B.: this used primary_wavelet_width_sample which has been suggested is not a valid measurement:  For the record:
primary_wavelet_width_sample = axial_primary_zero_crossing_after_sample - axial_primary_left_trough_time</p>
<p>a_mod:  k1 * a_reflection_coef
Not previously calculated, just plotted as reflection_coef, i.e. k1=1.0;
k1 a constant to be determined; may depend on MWD</p>
<p>a_reflection_coef: (1-R) / (1+R)
where R is the multiple-to-primary-amplitude ratio (axial)</p>
<p>a_str:  sqrt(self.axial_primary_peak_sample)
Previously known as pseudo_ucs;  We looked at logs of this quantity with
_sample resolution vs _poly (polynomail fit) and found little difference to
first order behaviour.</p>
<p>a_vel:  1 / a_delay
This is the “delay velocity”.  It is the one that has been ‘blocky’ in the past</p>
<p>c_density:  This will be some scaled version of a_dens, for now we set equal to a_dens
c_modulus:  This will be some scaled version of a_mod, for now we set equal to a_mod
c_strength:  This will be some scaled version of a_str, for now we set equal to a_str
c_velocity:  This will be some scaled version of a_vel, for now we set equal to a_vel</p>
<p>t_delay:   tangential_delay = tangential_multiple1_time_poly - tangential_primary_time_poly
Here we are using polynomial fits so we are not so ‘blocky’.  The label for this feature is 1810_tangential_delay</p>
<p>t_mod:  k2 * t_reflection_coef
Not previously calculated, k2 a constant to be determined; may depend on MWD</p>
<p>t_reflection_coef: (1-R) / (1+R) where R is the multiple-to-primary-amplitude ratio (tangential)</p>
<p>tangential_amplitude_ratio’ =  features[‘tangential_multiple1_amplitude_poly’] / ‘tangential_primary_amplitude_poly’]</p>
<p>t_vel:  1 / t_delay</p>
<p>s_modulus: This will be some scaled version of t_mod, for now we set equal to t_mod</p>
<p>s_velocity :This will be some scaled version of s_vel, for now we set equal to s_vel</p>
<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.a_delay">
<code class="descname">a_delay</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.a_delay" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the time delay between axial primary peak and axial multiple
peak. This is the “delay velocity”.  It is the one that has been
‘blocky’ in the past</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>None</strong> – </p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>feature version</strong> (<em>str</em>) – version of extractor deriver (here: ‘J0’)</li>
<li><strong>axial_primary_peak_time_sample</strong> (<em>float</em>) – time of the axial
primary peak from dataframe “df”</li>
<li><strong>axial_multiple_peak_time_sample</strong> (<em>float</em>) – time of the axial
multiple peak from datafram “df”</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt><strong>a_delay</strong>, the time delay between axial primary peak and</dt>
<dd><p class="first last">multiple peak</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float)</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In v1 this feature was calculated in direct features;
extracted_features_df[‘axial_delay’] =
extracted_features_df[‘axial_multiple_peak_time_sample’] -
extracted_features_df[‘axial_primary_peak_time_sample’]
Now we calc as a derived feature.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.a_amplitude_ratio">
<code class="descname">a_amplitude_ratio</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.a_amplitude_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the ratio between the primary peak amplitude and the
multiple peak amplitude.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>None</strong> – </p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>feature version</strong> (<em>str</em>) – version of extractor deriver (here: ‘J0’)</li>
<li><strong>axial_primary_peak_sample</strong> (<em>float</em>) – value of primary peak amplitude
from dataframe “df”</li>
<li><strong>axial_multiple_peak_sample</strong> (<em>float</em>) – value of multiple peak amplitude
from dataframe “df”</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Returns</dt>
<dd>(float): <strong>a_amplitude_ratio</strong>, the ratio between the primary peak
amplitude and the multiple peak amplitude</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.a_str">
<code class="descname">a_str</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.a_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the square root of the axial primary peak amplitude. Previously
known as pseudo_ucs;  We looked at logs of this quantity with _sample
resolution vs _poly (polynomail fit) and found little difference to
first order behaviour.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>None</strong> – </p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>feature version</strong> (<em>str</em>) – version of extractor deriver (here: ‘J0’)</li>
<li><strong>axial_primary_peak_sample</strong> (<em>float</em>) – the primary peak amplitude from
the dataframe “df”</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>a_str</strong>, the sqrt of the axial primary peak amplitude</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.a_vel">
<code class="descname">a_vel</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.a_vel" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the relative velocity of the axial wave using the inverse of
a_delay. This is the “delay velocity”.  It is the one that has been ‘blocky’
in the past</p>
<blockquote>
<div><div class="line-block">
<div class="line">a_vel:  1 / a_delay</div>
</div>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>None</strong> – </p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>feature version</strong> (<em>str</em>) – version of extractor deriver (here: ‘J0’)</li>
<li><strong>a_delay</strong> (<em>float</em>) – calculated in <code class="xref py py-meth docutils literal notranslate"><span class="pre">a_delay()</span></code></li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>a_vel</strong>, the delay velocity calculated from the axial component</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float)</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This does not take into account the distance from instrument
to tip, so this is not absolute velocity</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.a_reflection_coef">
<code class="descname">a_reflection_coef</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.a_reflection_coef" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the reflection coefficient between the drill/rock interface
from the axial primary and multiple peaks.</p>
<div class="line-block">
<div class="line">a_reflection_coef: (1-R) / (1+R)</div>
</div>
<p>Where R is the multiple-to-primary-amplitude ratio (axial)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>None</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><strong>a_amplitude_ratio</strong> (<em>float</em>) – calculated in <code class="xref py py-meth docutils literal notranslate"><span class="pre">a_amplitude_ratio()</span></code></td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the reflection coefficient from axial component features</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(float)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.a_mod">
<code class="descname">a_mod</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.a_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Scales the reflection coefficient based on drill setup to find modulus,</p>
<div class="line-block">
<div class="line">a_mod = k1 * a_reflection_coef.</div>
</div>
<p>Not previously calculated, just plotted as reflection_coef, i.e. k1=1.0;
k1 a constant to be determined; may depend on MWD.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>None</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><strong>a_reflection_coef</strong> (<em>float</em>) – calculated in <code class="xref py py-meth docutils literal notranslate"><span class="pre">a_reflection_coef()</span></code></td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>a_mod</strong>, the modulus from axial component features</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(float)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.a_dens">
<code class="descname">a_dens</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.a_dens" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates density of rock based on reflection coefficient and velocity,
Previously known as “pseudo_density”.</p>
<div class="line-block">
<div class="line">We have been calculating it as:</div>
<div class="line-block">
<div class="line">a_dens = reflection_coefficient_sample / primary_pseudo_velocity_sample**2</div>
</div>
</div>
<div class="line-block">
<div class="line">Which can be expressed as:</div>
<div class="line-block">
<div class="line">a_dens = reflection_coefficient_sample * self.primary_wavelet_width_sample**2</div>
</div>
</div>
<div class="line-block">
<div class="line">N.B.: this used primary_wavelet_width_sample which has been suggested is not a valid measurement.</div>
<div class="line">For the record:</div>
<div class="line-block">
<div class="line">primary_wavelet_width_sample = axial_primary_zero_crossing_after_sample - axial_primary_left_trough_time</div>
</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>None</strong> – </p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>a_reflection_coef</strong> (<em>float</em>) – calculated in <code class="xref py py-meth docutils literal notranslate"><span class="pre">a_reflection_coef()</span></code></li>
<li><strong>a_vel</strong> (<em>float</em>) – calculated in <code class="xref py py-meth docutils literal notranslate"><span class="pre">a_vel()</span></code></li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the derived density of the rock surrounding drill head</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.c_density">
<code class="descname">c_density</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.c_density" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be some scaled version of a_dens, for now we set equal to a_dens</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><div class="admonition-todo first last admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">20181224</p>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.c_modulus">
<code class="descname">c_modulus</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.c_modulus" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be some scaled version of a_mod, for now we set equal to a_mod</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><div class="admonition-todo first last admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">20181224</p>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.c_strength">
<code class="descname">c_strength</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.c_strength" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be some scaled version of a_str, for now we set equal to a_str</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><div class="admonition-todo first last admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<p class="last">20181224</p>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.c_velocity">
<code class="descname">c_velocity</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.c_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be some scaled version of a_vel, for now we set equal to a_vel</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><div class="admonition-todo first last admonition" id="index-3">
<p class="first admonition-title">Todo</p>
<p class="last">20181224</p>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.t_delay">
<code class="descname">t_delay</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.t_delay" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the tangential time delay between the arrival of the primary peak
and the multiple peak. Here we are using polynomial fits so we are not
so ‘blocky’.  The label for this feature is 1810_tangential_delay.</p>
<blockquote>
<div><div class="line-block">
<div class="line">tangential_delay = tangential_multiple1_time_poly - tangential_primary_time_poly</div>
</div>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>None</strong> – </p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>1810_tangential_primary_time_poly</strong> (<em>float</em>) – arrival time of the primary
peak along the tangential component</li>
<li><strong>1810_tangential_multiple1_time_poly</strong> (<em>float</em>) – arrival time of the first
multiple peak along the tangential component</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt><strong>t_delay</strong>, the time betweent the arrival of the primary</dt>
<dd><p class="first last">and first multiple peaks along the tangential component.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(float)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.t_amplitude_ratio">
<code class="descname">t_amplitude_ratio</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.t_amplitude_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the ratio between the primary peak amplitude and the
multiple peak amplitude on the tangential component.</p>
<blockquote>
<div><div class="line-block">
<div class="line">tangential_amplitude_ratio =  ‘tangential_multiple1_amplitude_poly’ / ‘tangential_primary_amplitude_poly’</div>
</div>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>None</strong> – </p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>feature version</strong> (<em>str</em>) – version of extractor deriver (here: ‘1810’)</li>
<li><strong>tangential_primary_amplitude_poly</strong> (<em>float</em>) – value of primary peak amplitude
from dataframe “df”</li>
<li><strong>tangential_multiple1_amplitude_poly</strong> (<em>float</em>) – value of multiple peak amplitude
from dataframe “df”</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Returns</dt>
<dd>(float): <strong>t_amplitude_ratio</strong>, the ratio between the primary peak
amplitude and the multiple peak amplitude</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This was calculated in the 1810 features, but because it is not a derived
quantity I would rather calculate it here.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">1810 features were applying a square root to the amplitude ratio;
fixed here.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.t_reflection_coef">
<code class="descname">t_reflection_coef</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.t_reflection_coef" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the reflection coefficient between the drill/rock interface
from the tangential primary and multiple peaks.</p>
<blockquote>
<div><div class="line-block">
<div class="line">t_reflection_coef: (1-R) / (1+R)</div>
</div>
</div></blockquote>
<p>Where R is the multiple-to-primary-amplitude ratio (tangential)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>None</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><strong>t_amplitude_ratio</strong> (<em>float</em>) – calculated in <code class="xref py py-meth docutils literal notranslate"><span class="pre">t_amplitude_ratio()</span></code></td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the reflection coefficient from tangential component features</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(float)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.t_mod">
<code class="descname">t_mod</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.t_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Scales the reflection coefficient based on drill setup to find modulus,</p>
<blockquote>
<div><div class="line-block">
<div class="line">t_mod:  k2 * t_reflection_coef</div>
</div>
</div></blockquote>
<p>Not previously calculated, just plotted as reflection_coef, i.e. k1=1.0;
k2 a constant to be determined; may depend on MWD.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>None</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><strong>t_reflection_coef</strong> (<em>float</em>) – calculated in <code class="xref py py-meth docutils literal notranslate"><span class="pre">t_reflection_coef()</span></code></td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>t_mod</strong>, the modulus from tangential component features</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(float)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.t_vel">
<code class="descname">t_vel</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.t_vel" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the relative velocity of the tangential wave using the inverse of
t_delay. This is the “delay velocity”.  It is the one that has been ‘blocky’
in the past</p>
<blockquote>
<div><div class="line-block">
<div class="line">t_vel:  1 / t_delay</div>
</div>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>None</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><strong>t_delay</strong> (<em>float</em>) – calculated in <code class="xref py py-meth docutils literal notranslate"><span class="pre">t_delay()</span></code></td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>t_vel</strong>, the delay velocity calculated from the tangential component</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(float)</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This does not take into account the distance from instrument
to tip, so this is not absolute velocity but delay velocity</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.s_modulus">
<code class="descname">s_modulus</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.s_modulus" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be some scaled version of t_mod, for now we set equal to t_mod</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><div class="admonition-todo first last admonition" id="index-4">
<p class="first admonition-title">Todo</p>
<p class="last">20181224</p>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="external_feature_derivations.DerivedFeatureExtractorV0.s_velocity">
<code class="descname">s_velocity</code><a class="headerlink" href="#external_feature_derivations.DerivedFeatureExtractorV0.s_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be some scaled version of t_vel, for now we set equal to t_vel</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><div class="admonition-todo first last admonition" id="index-5">
<p class="first admonition-title">Todo</p>
<p class="last">20181224</p>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="external_feature_derivations.extracted_features_df_to_external_features">
<code class="descname">extracted_features_df_to_external_features</code><span class="sig-paren">(</span><em>extracted_features</em><span class="sig-paren">)</span><a class="headerlink" href="#external_feature_derivations.extracted_features_df_to_external_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Consolidates derived features and adds them to already extracted features.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>extracted_features</strong> (<em>dataframe</em>) – the features extracted prior to derived features</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>a_delay</strong> (<em>float</em>) – found here <code class="xref py py-meth docutils literal notranslate"><span class="pre">a_delay()</span></code></li>
<li><strong>a_dens</strong> (<em>float</em>) – found here <code class="xref py py-meth docutils literal notranslate"><span class="pre">a_dens()</span></code></li>
<li><strong>a_mod</strong> (<em>float</em>) – found here <code class="xref py py-meth docutils literal notranslate"><span class="pre">a_mod()</span></code></li>
<li><strong>a_reflection_coef</strong> (<em>float</em>) – found here <code class="xref py py-meth docutils literal notranslate"><span class="pre">a_reflection_coef()</span></code></li>
<li><strong>a_vel</strong> (<em>float</em>) – found here <code class="xref py py-meth docutils literal notranslate"><span class="pre">a_vel()</span></code></li>
<li><strong>c_modulus</strong> (<em>float</em>) – found here <code class="xref py py-meth docutils literal notranslate"><span class="pre">c_modulus()</span></code></li>
<li><strong>c_strength</strong> (<em>float</em>) – found here <code class="xref py py-meth docutils literal notranslate"><span class="pre">c_strength()</span></code></li>
<li><strong>c_velocity</strong> (<em>float</em>) – found here <code class="xref py py-meth docutils literal notranslate"><span class="pre">c_velocity()</span></code></li>
<li><strong>c_density</strong> (<em>float</em>) – found here <code class="xref py py-meth docutils literal notranslate"><span class="pre">c_density()</span></code></li>
<li><strong>t_delay</strong> (<em>float</em>) – found here <code class="xref py py-meth docutils literal notranslate"><span class="pre">t_delay()</span></code></li>
<li><strong>t_mod</strong> (<em>float</em>) – found here <code class="xref py py-meth docutils literal notranslate"><span class="pre">t_mod()</span></code></li>
<li><strong>t_reflection_coef</strong> (<em>float</em>) – found here <code class="xref py py-meth docutils literal notranslate"><span class="pre">t_reflection_coef()</span></code></li>
<li><strong>s_modulus</strong> (<em>float</em>) – found here <code class="xref py py-meth docutils literal notranslate"><span class="pre">s_modulus()</span></code></li>
<li><strong>s_velocity</strong> (<em>float</em>) – found here <code class="xref py py-meth docutils literal notranslate"><span class="pre">s_velocity()</span></code></li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>output_features</strong>, dataframe of extracted features and
derived features</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(dataframe)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="external_feature_derivations.test">
<code class="descname">test</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#external_feature_derivations.test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="external_feature_derivations.main">
<code class="descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#external_feature_derivations.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div></blockquote>
</div>
<div class="section" id="intermediate-deriver">
<h2>Intermediate Deriver<a class="headerlink" href="#intermediate-deriver" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><span class="target" id="module-intermediate_derived_features"></span><p>Author: kkappler</p>
<div class="admonition-todo admonition" id="index-6">
<p class="first admonition-title">Todo</p>
<p class="last">20190220: The features extracted here are not pulled directly from wavelets, so
we refer to them as derived features rather than ‘direct’ features.  THey
will in future versions of the rhino software be superceded log processing,
and possibly reinstututed once log-processing and calibrations are better understood.</p>
</div>
<dl class="class">
<dt id="intermediate_derived_features.IntermediateFeatureDeriver">
<em class="property">class </em><code class="descname">IntermediateFeatureDeriver</code><span class="sig-paren">(</span><em>df_dict=None</em><span class="sig-paren">)</span><a class="headerlink" href="#intermediate_derived_features.IntermediateFeatureDeriver" title="Permalink to this definition">¶</a></dt>
<dd><p>Derives the following features:</p>
<blockquote>
<div><ul class="simple">
<li>axial_primary_peak</li>
<li>axial_amplitude_ratio_1</li>
<li>axial_amplitude_ratio_2</li>
<li>axial_reflection_coefficient_1</li>
<li>axial_reflection_coefficient_2</li>
<li>axial_delay_1</li>
<li>axial_delay_2</li>
<li>axial_pseudo_velocity_1</li>
<li>axial_pseudo_velocity_2</li>
<li>pseudo_ucs</li>
<li>pseudo_density</li>
<li>tangential_primary_peak</li>
<li>tangential_primary_peak_time</li>
<li>tangential_delay_1</li>
<li>tangential_delay_2</li>
<li>tangential_amplitude_ratio_1</li>
<li>tangential_amplitude_ratio_2</li>
<li>tangential_reflection_coefficient_1</li>
<li>tangential_reflection_coefficient_2</li>
<li>tangential_pseudo_velocity_1</li>
</ul>
</div></blockquote>
<dl class="method">
<dt id="intermediate_derived_features.IntermediateFeatureDeriver.derive_features">
<code class="descname">derive_features</code><span class="sig-paren">(</span><em>component_id</em><span class="sig-paren">)</span><a class="headerlink" href="#intermediate_derived_features.IntermediateFeatureDeriver.derive_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Store certain features in dictionary, based on component_id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>component_id</strong> (<em>str</em>) – axial/tangential</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">derived features<blockquote>
<div>For axial:<blockquote>
<div><ul class="simple">
<li>pseudo ucs</li>
<li>axial pseudo velocity 1</li>
<li>pseudo density</li>
<li>axial reflection coeff</li>
</ul>
</div></blockquote>
<p>For tangential:</p>
<blockquote>
<div><ul class="simple">
<li>tangential reflection coeff 1</li>
<li>tangential reflection coeff 2</li>
<li>tangential delay 1</li>
<li>tangential pseudo velocity 1</li>
</ul>
</div></blockquote>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(dict)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/DC_Logo_Padded.png" alt="Logo"/>
            </a></p>
    <ul>
<li class="toctree-l1"><a class="reference internal" href="../contents.html">DataCloud Rhino Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contents.html#documenting-with-sphinx">Documenting with Sphinx</a></li>
</ul>


  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/module_docs/feature_extraction_docs/bderivdoc.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">DataCloud Rhino 1.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, DataCloud.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
  </body>
</html>